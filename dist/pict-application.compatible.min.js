"use strict";function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&_setPrototypeOf(t,i)}function _setPrototypeOf(t,i){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},_setPrototypeOf(t,i)}function _createSuper(t){var i=_isNativeReflectConstruct();return function(){var e,o=_getPrototypeOf(t);if(i){var n=_getPrototypeOf(this).constructor;e=Reflect.construct(o,arguments,n)}else e=o.apply(this,arguments);return _possibleConstructorReturn(this,e)}}function _possibleConstructorReturn(t,i){if(i&&("object"===_typeof(i)||"function"==typeof i))return i;if(void 0!==i)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,i){for(var e=0;e<i.length;e++){var o=i[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,i,e){return i&&_defineProperties(t.prototype,i),e&&_defineProperties(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function _defineProperty(t,i,e){return(i=_toPropertyKey(i))in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"===_typeof(i)?i:String(i)}function _toPrimitive(t,i){if("object"!==_typeof(t)||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var o=e.call(t,i||"default");if("object"!==_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===i?String:Number)(t)}function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}!function(t){if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).PictApplication=t()}}((function(){return function t(i,e,o){function n(a,r){if(!e[a]){if(!i[a]){var c="function"==typeof require&&require;if(!r&&c)return c(a,!0);if(s)return s(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var h=e[a]={exports:{}};i[a][0].call(h.exports,(function(t){return n(i[a][1][t]||t)}),h,h.exports,t,i,e,o)}return e[a].exports}for(var s="function"==typeof require&&require,a=0;a<o.length;a++)n(o[a]);return n}({1:[function(t,i,e){var o=function(){function t(i,e){_classCallCheck(this,t),this.fable=!1,this.options="object"===_typeof(i)?i:{},this.serviceType="Unknown",this.UUID="CORESVC-".concat(Math.floor(89999*Math.random()+1e4)),this.Hash="string"==typeof e?e:"".concat(this.UUID)}return _createClass(t,[{key:"connectFable",value:function(t){return this.fable=t,!0}}]),t}();_defineProperty(o,"isFableService",!0),i.exports=o},{}],2:[function(t,i,e){var o=_createClass((function t(i,e,o){_classCallCheck(this,t),this.fable=i,this.options="object"===_typeof(e)?e:"object"!==_typeof(i)||i.isFable?{}:i,this.serviceType="Unknown","function"==typeof i.getUUID?this.UUID=i.getUUID():this.UUID="NoFABLESVC-".concat(Math.floor(89999*Math.random()+1e4)),this.Hash="string"==typeof o?o:"".concat(this.UUID),this.log=this.fable.log,this.servicesMap=this.fable.servicesMap,this.services=this.fable.services}));_defineProperty(o,"isFableService",!0),i.exports=o,i.exports.CoreServiceProviderBase=t("./Fable-ServiceProviderBase-Preinit.js")},{"./Fable-ServiceProviderBase-Preinit.js":1}],3:[function(t,i,e){var o=t("fable-serviceproviderbase"),n={Name:"DefaultPictApplication",MainViewportViewIdentifier:"Default-View",MainViewportRenderableHash:!1,MainViewportDestinationAddress:!1,MainViewportDefaultDataAddress:!1,AutoSolveAfterInitialize:!0,AutoRenderMainViewportViewAfterInitialize:!0,Manifests:{},IdentifierAddressPrefix:"PICT-"},s=function(t){_inherits(e,t);var i=_createSuper(e);function e(t,o,s){var a;_classCallCheck(this,e);var r=Object.assign({},JSON.parse(JSON.stringify(n)),o);(a=i.call(this,t,r,s)).serviceType="PictApplication",a.pict=a.fable,a.AppData=a.fable.AppData,a.initializeTimestamp=!1,a.lastSolvedTimestamp=!1,a.lastMarshalFromViewsTimestamp=!1,a.lastMarshalToViewsTimestamp=!1;var c=Object.keys(a.options.Manifests);if(c.length>0)for(var l=0;l<c.length;l++){var h=c[l];a.fable.serviceManager.instantiateServiceProvider("Manifest",a.options.Manifests[h],h)}return a}return _createClass(e,[{key:"onBeforeSolve",value:function(){return this.pict.LogNoisiness>3&&this.log.trace("PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," onBeforeSolve:")),!0}},{key:"onBeforeSolveAsync",value:function(t){return this.onBeforeSolve(),t()}},{key:"onSolve",value:function(){return this.pict.LogNoisiness>3&&this.log.trace("PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," onSolve:")),!0}},{key:"onSolveAsync",value:function(t){return this.onSolve(),t()}},{key:"solve",value:function(){this.pict.LogNoisiness>2&&this.log.trace("PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," executing solve() function...")),this.onBeforeSolve();for(var t=Object.keys(this.pict.views),i=[],e=0;e<t.length;e++){var o=this.pict.views[t[e]];o.options.AutoInitialize&&i.push(o)}i.sort((function(t,i){return t.options.AutoInitializeOrdinal-i.options.AutoInitializeOrdinal}));for(var n=0;n<i.length;n++)i[n].solve();return this.onSolve(),this.onAfterSolve(),this.lastSolvedTimestamp=this.fable.log.getTimeStamp(),!0}},{key:"solveAsync",value:function(t){var i=this,e=this.fable.serviceManager.instantiateServiceProviderWithoutRegistration("Anticipate");e.anticipate(this.onBeforeSolveAsync.bind(this));for(var o=Object.keys(this.pict.views),n=[],s=0;s<o.length;s++){var a=this.pict.views[o[s]];a.options.AutoSolveWithApp&&n.push(a)}n.sort((function(t,i){return t.options.AutoSolveOrdinal-i.options.AutoSolveOrdinal}));for(var r=0;r<n.length;r++)e.anticipate(n[r].solveAsync.bind(n[r]));e.anticipate(this.onSolveAsync.bind(this)),e.anticipate(this.onAfterSolveAsync.bind(this)),e.wait((function(e){return i.pict.LogNoisiness>2&&i.log.trace("PictApp [".concat(i.UUID,"]::[").concat(i.Hash,"] ").concat(i.options.Name," solveAsync() complete.")),i.lastSolvedTimestamp=i.fable.log.getTimeStamp(),t(e)}))}},{key:"onAfterSolve",value:function(){return this.pict.LogNoisiness>3&&this.log.trace("PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," onAfterSolve:")),!0}},{key:"onAfterSolveAsync",value:function(t){return this.onAfterSolve(),t()}},{key:"onBeforeInitialize",value:function(){return this.pict.LogNoisiness>3&&this.log.trace("PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," onBeforeInitialize:")),!0}},{key:"onBeforeInitializeAsync",value:function(t){return this.onBeforeInitialize(),t()}},{key:"onInitialize",value:function(){return this.pict.LogNoisiness>3&&this.log.trace("PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," onInitialize:")),!0}},{key:"onInitializeAsync",value:function(t){return this.onInitialize(),t()}},{key:"initialize",value:function(){if(this.initializeTimestamp)return this.log.warn("PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," initialize called but initialization is already completed.  Aborting.")),!1;this.onBeforeInitialize(),this.onInitialize();for(var t=Object.keys(this.pict.views),i=[],e=0;e<t.length;e++){var o=this.pict.views[t[e]];o.options.AutoInitialize&&i.push(o)}i.sort((function(t,i){return t.options.AutoInitializeOrdinal-i.options.AutoInitializeOrdinal}));for(var n=0;n<i.length;n++)i[n].initialize();return this.onAfterInitialize(),this.options.AutoSolveAfterInitialize&&(this.pict.LogNoisiness>1&&this.log.trace("PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," auto solving after initialization...")),this.solve()),this.options.AutoRenderMainViewportViewAfterInitialize&&(this.pict.LogNoisiness>1&&this.log.trace("PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," auto rendering after initialization...")),this.render()),this.initializeTimestamp=this.fable.log.getTimeStamp(),!0}},{key:"initializeAsync",value:function(t){var i=this;if(this.initializeTimestamp)return this.log.warn("PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," async initialize called but initialization is already completed.  Aborting.")),fCallback();var e=this.fable.serviceManager.instantiateServiceProviderWithoutRegistration("Anticipate");this.pict.LogNoisiness>3&&this.log.trace("PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," beginning initialization...")),e.anticipate(this.onBeforeInitializeAsync.bind(this)),e.anticipate(this.onInitializeAsync.bind(this));for(var o=Object.keys(this.pict.views),n=[],s=0;s<o.length;s++){var a=this.pict.views[o[s]];a.options.AutoInitialize&&n.push(a)}n.sort((function(t,i){return t.options.AutoInitializeOrdinal-i.options.AutoInitializeOrdinal}));for(var r=0;r<n.length;r++){var c=n[r];e.anticipate(c.initializeAsync.bind(c))}e.anticipate(this.onAfterInitializeAsync.bind(this)),this.options.AutoSolveAfterInitialize&&(this.pict.LogNoisiness>1&&this.log.trace("PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," auto solving (asynchronously) after initialization...")),e.anticipate(this.solveAsync.bind(this))),this.options.AutoRenderMainViewportViewAfterInitialize&&(this.pict.LogNoisiness>1&&this.log.trace("PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," auto rendering (asynchronously) after initialization...")),e.anticipate(this.renderMainViewportAsync.bind(this))),e.wait((function(e){return i.initializeTimestamp=i.fable.log.getTimeStamp(),i.pict.LogNoisiness>2&&i.log.trace("PictApp [".concat(i.UUID,"]::[").concat(i.Hash,"] ").concat(i.options.Name," initialization complete.")),t()}))}},{key:"onAfterInitialize",value:function(){return this.pict.LogNoisiness>3&&this.log.trace("PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," onAfterInitialize:")),!0}},{key:"onAfterInitializeAsync",value:function(t){return this.onAfterInitialize(),t()}},{key:"onBeforeMarshalFromViews",value:function(){return this.pict.LogNoisiness>3&&this.log.trace("PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," onBeforeMarshalFromViews:")),!0}},{key:"onBeforeMarshalFromViewsAsync",value:function(t){return this.onBeforeMarshalFromViews(),t()}},{key:"onMarshalFromViews",value:function(){return this.pict.LogNoisiness>3&&this.log.trace("PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," onMarshalFromViews:")),!0}},{key:"onMarshalFromViewsAsync",value:function(t){return this.onMarshalFromViews(),t()}},{key:"marshalFromViews",value:function(){this.pict.LogNoisiness>2&&this.log.trace("PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," executing marshalFromViews() function...")),this.onBeforeMarshalFromViews();for(var t=Object.keys(this.pict.views),i=[],e=0;e<t.length;e++){var o=this.pict.views[t[e]];i.push(o)}for(var n=0;n<i.length;n++)i[n].marshalFromView();return this.onMarshalFromViews(),this.onAfterMarshalFromViews(),this.lastMarshalFromViewsTimestamp=this.fable.log.getTimeStamp(),!0}},{key:"marshalFromViewsAsync",value:function(t){var i=this,e=this.fable.serviceManager.instantiateServiceProviderWithoutRegistration("Anticipate");e.anticipate(this.onBeforeMarshalFromViewsAsync.bind(this));for(var o=Object.keys(this.pict.views),n=[],s=0;s<o.length;s++){var a=this.pict.views[o[s]];n.push(a)}for(var r=0;r<n.length;r++)e.anticipate(n[r].marshalFromViewAsync.bind(n[r]));e.anticipate(this.onMarshalFromViewsAsync.bind(this)),e.anticipate(this.onAfterMarshalFromViewsAsync.bind(this)),e.wait((function(e){return i.pict.LogNoisiness>2&&i.log.trace("PictApp [".concat(i.UUID,"]::[").concat(i.Hash,"] ").concat(i.options.Name," marshalFromViewsAsync() complete.")),i.lastMarshalFromViewsTimestamp=i.fable.log.getTimeStamp(),t(e)}))}},{key:"onAfterMarshalFromViews",value:function(){return this.pict.LogNoisiness>3&&this.log.trace("PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," onAfterMarshalFromViews:")),!0}},{key:"onAfterMarshalFromViewsAsync",value:function(t){return this.onAfterMarshalFromViews(),t()}},{key:"onBeforeMarshalToViews",value:function(){return this.pict.LogNoisiness>3&&this.log.trace("PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," onBeforeMarshalToViews:")),!0}},{key:"onBeforeMarshalToViewsAsync",value:function(t){return this.onBeforeMarshalToViews(),t()}},{key:"onMarshalToViews",value:function(){return this.pict.LogNoisiness>3&&this.log.trace("PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," onMarshalToViews:")),!0}},{key:"onMarshalToViewsAsync",value:function(t){return this.onMarshalToViews(),t()}},{key:"marshalToViews",value:function(){this.pict.LogNoisiness>2&&this.log.trace("PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," executing marshalToViews() function...")),this.onBeforeMarshalToViews();for(var t=Object.keys(this.pict.views),i=[],e=0;e<t.length;e++){var o=this.pict.views[t[e]];i.push(o)}for(var n=0;n<i.length;n++)i[n].marshalToView();return this.onMarshalToViews(),this.onAfterMarshalToViews(),this.lastMarshalToViewsTimestamp=this.fable.log.getTimeStamp(),!0}},{key:"marshalToViewsAsync",value:function(t){var i=this,e=this.fable.serviceManager.instantiateServiceProviderWithoutRegistration("Anticipate");e.anticipate(this.onBeforeMarshalToViewsAsync.bind(this));for(var o=Object.keys(this.pict.views),n=[],s=0;s<o.length;s++){var a=this.pict.views[o[s]];n.push(a)}for(var r=0;r<n.length;r++)e.anticipate(n[r].marshalToViewAsync.bind(n[r]));e.anticipate(this.onMarshalToViewsAsync.bind(this)),e.anticipate(this.onAfterMarshalToViewsAsync.bind(this)),e.wait((function(e){return i.pict.LogNoisiness>2&&i.log.trace("PictApp [".concat(i.UUID,"]::[").concat(i.Hash,"] ").concat(i.options.Name," marshalToViewsAsync() complete.")),i.lastMarshalToViewsTimestamp=i.fable.log.getTimeStamp(),t(e)}))}},{key:"onAfterMarshalToViews",value:function(){return this.pict.LogNoisiness>3&&this.log.trace("PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," onAfterMarshalToViews:")),!0}},{key:"onAfterMarshalToViewsAsync",value:function(t){return this.onAfterMarshalToViews(),t()}},{key:"render",value:function(t,i,e,o){var n=void 0===t?this.options.MainViewportViewIdentifier:t,s=void 0===i?this.options.MainViewportRenderableHash:i,a=void 0===e?this.options.MainViewportDestinationAddress:e,r=void 0===o?this.options.MainViewportDefaultDataAddress:o,c="string"==typeof n&&this.servicesMap.PictView[n];return c?c.render(s,a,r):(this.log.error("PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," could not render from View ").concat(n," because it is not a valid view.")),!1)}},{key:"renderMainViewport",value:function(){return this.render(this.options.MainViewportViewIdentifier,this.options.MainViewportRenderableHash,this.options.MainViewportDestinationAddress,this.options.MainViewportDefaultDataAddress)}},{key:"renderAsync",value:function(t,i,e,o,n){var s=void 0===t?this.options.MainViewportViewIdentifier:t,a=void 0===i?this.options.MainViewportRenderableHash:i,r=void 0===e?this.options.MainViewportDestinationAddress:e,c=void 0===o?this.options.MainViewportDefaultDataAddress:o,l="string"==typeof s&&this.servicesMap.PictView[s];if(!l){var h="PictApp [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.Name," could not asynchronously render from View ").concat(s," because it is not a valid view.");return this.pict.LogNoisiness>3&&this.log.error(h),n(new Error(h))}return l.renderAsync(a,r,c,n)}},{key:"renderMainViewportAsync",value:function(t){return this.renderAsync(this.options.MainViewportViewIdentifier,this.options.MainViewportRenderableHash,this.options.MainViewportDestinationAddress,this.options.MainViewportDefaultDataAddress,t)}}]),e}(o);i.exports=s},{"fable-serviceproviderbase":2}]},{},[3])(3)}));
//# sourceMappingURL=pict-application.compatible.min.js.map
